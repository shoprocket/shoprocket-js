# Migration to shadcn CSS Variable Standard

## Overview
This document tracks the migration from our custom CSS variable naming to the shadcn/ui standard.

## Phase 1: Variable Mapping

### Color Variables (CHANGE)

| Our Variable | shadcn Standard | Usage Count | Notes |
|--------------|-----------------|-------------|-------|
| `--color-background` | `--background` | - | Remove `color-` prefix |
| `--color-text` | `--foreground` | 23 | "text" → "foreground" |
| `--color-on-surface` | `--card-foreground` | 55 | **HIGH IMPACT** - most used! |
| `--color-surface` | `--card` | 17 | "surface" → "card" |
| `--color-surface-hover` | `--muted` | 7 | **DELETE** - wrong semantic |
| `--color-text-muted` | `--muted-foreground` | 42 | Reorder: text-muted → muted-foreground |
| `--color-primary` | `--primary` | 49 | Remove `color-` prefix |
| `--color-on-primary` | `--primary-foreground` | 12 | "on-primary" → "primary-foreground" |
| `--color-border` | `--border` | 30 | Remove `color-` prefix |
| `--color-hover` | `--secondary` | 9 | Map to secondary background |
| `--color-error` | `--destructive` | 8 | "error" → "destructive" |
| `--color-on-error` | `--destructive-foreground` | 2 | "on-error" → "destructive-foreground" |
| `--color-success` | `--success` | 11 | **CUSTOM** - not in shadcn (keep as-is) |
| `--color-on-success` | `--success-foreground` | 2 | **CUSTOM** - not in shadcn (keep as-is) |
| `--color-warning` | `--warning` | 2 | **CUSTOM** - not in shadcn (keep as-is) |
| `--color-info` | `--info` | - | **CUSTOM** - not in shadcn (keep as-is) |
| `--color-card-bg` | `--card` | - | Duplicate of surface, remove |
| `--color-overlay` | `--overlay` | 2 | **CUSTOM** - keep for modals |
| `--color-danger` | `--destructive` | - | Alias for error, use destructive |

### RGB Variants (KEEP)

| Our Variable | Action | Notes |
|--------------|--------|-------|
| `--color-primary-rgb` | **KEEP** | Used for rgba() opacity |
| `--color-surface-rgb` | **KEEP** | Used for rgba() opacity |
| `--color-text-rgb` | **KEEP** | Used for rgba() opacity |
| `--color-warning-bg` | **KEEP** | Custom utility color |
| `--color-warning-text` | **KEEP** | Custom utility color |

### ShopRocket Custom Variables (KEEP - NO CHANGE)

These are our widget-specific customizations beyond the theme system:

| Variable | Purpose | Keep? |
|----------|---------|-------|
| `--sr-radius` | Border radius override | ✅ YES |
| `--sr-button-font-size` | Button text size | ✅ YES |
| `--sr-button-padding-x` | Button horizontal padding | ✅ YES |
| `--sr-button-padding-y` | Button vertical padding | ✅ YES |
| `--sr-button-primary-opacity-hover` | Primary button hover opacity | ✅ YES |
| `--sr-product-title-size` | Product title font size | ✅ YES |
| `--sr-product-price-size` | Product price font size | ✅ YES |
| `--sr-product-section-gap` | Product section spacing | ✅ YES |
| `--sr-product-image-radius` | Product image border radius | ✅ YES |
| `--sr-product-image-aspect-ratio` | Product image aspect ratio | ✅ YES |
| `--sr-product-grid-padding` | Product grid spacing | ✅ YES |
| `--sr-card-padding` | Card internal padding | ✅ YES |
| `--sr-category-cols` | Category grid columns | ✅ YES |
| `--sr-category-title-size` | Category title size | ✅ YES |
| `--sr-modal-background` | Modal background color | ✅ YES |
| `--sr-modal-border-radius` | Modal border radius | ✅ YES |
| `--sr-modal-close-background` | Modal close button bg | ✅ YES |
| `--sr-modal-close-hover-background` | Modal close hover | ✅ YES |
| `--sr-modal-close-color` | Modal close icon color | ✅ YES |

### Layout Variables (KEEP - NO CHANGE)

| Variable | Purpose |
|----------|---------|
| `--cart-panel-width` | Cart drawer width |
| `--cart-size` | Cart size mode |
| `--cart-size-sm` | Cart small breakpoint |
| `--cols` | Grid columns |
| `--cols-md` | Grid columns medium |
| `--cols-sm` | Grid columns small |
| `--spacing` | Base spacing unit |

### Utility Variables (KEEP - NO CHANGE)

| Variable | Purpose |
|----------|---------|
| `--shadow-card` | Card shadow definition |
| `--skeleton-shimmer-gradient` | Loading skeleton gradient |
| `--skeleton-shimmer-duration` | Loading animation duration |

### Tailwind Internal Variables (IGNORE)

All `--tw-*` variables are generated by Tailwind and should not be touched.

## shadcn Standard Variables

For reference, here's the complete shadcn variable set:

```css
/* Core Theme Colors */
--background: #ffffff;
--foreground: #333333;

/* Cards & Surfaces */
--card: #ffffff;
--card-foreground: #333333;

/* Popovers & Overlays */
--popover: #ffffff;
--popover-foreground: #333333;

/* Brand Colors */
--primary: #3b82f6;
--primary-foreground: #ffffff;

/* Secondary Elements */
--secondary: #f3f4f6;
--secondary-foreground: #4b5563;

/* Muted/De-emphasized */
--muted: #f9fafb;
--muted-foreground: #6b7280;

/* Accent/Highlights */
--accent: #e0f2fe;
--accent-foreground: #1e3a8a;

/* Destructive/Errors */
--destructive: #ef4444;
--destructive-foreground: #ffffff;

/* Form Elements */
--border: #e5e7eb;
--input: #e5e7eb;
--ring: #3b82f6;

/* Typography */
--radius: 0.375rem;
```

## Variables We'll Keep (Not in shadcn)

These are widget-specific and don't map to shadcn:

1. **State Colors:** `--success`, `--success-foreground`, `--warning`, `--info`
   - **Why:** shadcn only has `destructive` for errors, we need success/warning/info
   - **Action:** Keep these, document as custom extensions

2. **Utility Colors:** `--overlay`, `--color-warning-bg`, `--color-warning-text`
   - **Why:** Used for specific UI patterns (modals, notifications)
   - **Action:** Keep as-is

3. **RGB Variants:** `--primary-rgb`, `--surface-rgb`, `--text-rgb`
   - **Why:** Used for rgba() opacity calculations
   - **Action:** Keep as-is

4. **SR Custom Vars:** All `--sr-*` variables
   - **Why:** Widget-specific customization beyond theming
   - **Action:** Keep as-is

## Migration Strategy

### Search & Replace Order (Important!)

Execute in this order to avoid conflicts:

```bash
# 1. Most specific first (avoid partial matches)
--color-on-surface → --card-foreground
--color-surface-hover → --muted  # DELETE - wrong semantic
--color-surface-rgb → --card-rgb
--color-surface → --card

# 2. Text/foreground colors
--color-text-muted → --muted-foreground
--color-text-rgb → --foreground-rgb
--color-text → --foreground

# 3. Primary colors
--color-on-primary → --primary-foreground
--color-primary-rgb → --primary-rgb
--color-primary → --primary

# 4. Error/destructive
--color-on-error → --destructive-foreground
--color-error → --destructive
--color-danger → --destructive

# 5. Simple prefixes (do last to avoid conflicts)
--color-border → --border
--color-hover → --secondary
--color-card-bg → --card  # Remove duplicate

# 6. Keep as-is (no replacement)
--color-success → --success  # CUSTOM
--color-on-success → --success-foreground  # CUSTOM
--color-warning → --warning  # CUSTOM
--color-info → --info  # CUSTOM
--color-overlay → --overlay  # CUSTOM
```

### Files to Update

1. **Widget CSS:** `/packages/widget/src/styles.css` (~3000 lines)
2. **Backend Themes:** `/config/widget-themes.php` (41 themes × 2 modes)
3. **Database:** `store_themes.css_variables` JSON column
4. **Seeder:** Update `ThemePresetSeeder.php` to use new names

## Validation Checklist

After migration, verify:

- [ ] All theme colors still render correctly
- [ ] Light/dark mode switching works
- [ ] Contrast ratios still pass WCAG (4.5:1 minimum)
- [ ] No broken CSS references (check browser console)
- [ ] tweakcn themes can be imported directly
- [ ] Database themes match config file
- [ ] No duplicate variable definitions

## Rollback Plan

Before starting:
1. ✅ Backup `styles.css`
2. ✅ Backup `widget-themes.php`
3. ✅ Export `store_themes` table to SQL dump
4. ✅ Tag git commit before migration

If issues occur:
1. Restore from backups
2. Clear Laravel cache: `php artisan cache:clear`
3. Rebuild widget: `npm run build`

## Benefits After Migration

1. ✅ **Import tweakcn themes directly** - No conversion needed
2. ✅ **Standard documentation** - Use shadcn docs
3. ✅ **Cleaner variable names** - `--muted` vs `--color-text-muted`
4. ✅ **Better semantics** - `--card-foreground` vs invented `--color-on-surface`
5. ✅ **Future-proof** - Industry standard, widely adopted
6. ✅ **Easier onboarding** - Developers know shadcn
